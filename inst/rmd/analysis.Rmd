---
title: "Cid Cluster Analysis"
date: "Monday, August 04, 2014"
output: html_document
---

```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
#input data
#UI
#base_path="/home/devtest/"
#local
base_path="D:/"
pt<-paste(base_path,"sg_2.txt",sep="")
sg<-read.csv(pt,sep="\t")
nrow(sg)
```

<p><b><u> Head of data</u></b></p>
```{r results='asis',warning=FALSE,error=FALSE,echo=F,comment=NA,tidy = F}
library(xtable)
x=head(sg)
cnames=colnames(x)
x=t(x)
x=apply(x,2,as.character)
x=as.data.frame(x)
x=t(x)
x=as.data.frame(x)
cnames->colnames(x)
print(xtable(x,display=rep("s",dim(x)[2]+1)),type="html",include.rownames=FALSE)
```
<br/>
```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
#operations
#Date level plots
plot.ts(unique(sg$dte),by(sg$t_rev,sg$dte,sum),xlab="Date",ylab="Sum of Revenue",xy.labels =as.character(by(sg$t_rev,sg$dte,sum)),col="darkslateblue");grid(col="grey")
plot.ts(unique(sg$dte),by(sg$t_cost,sg$dte,sum),xlab="Date",ylab="Sum of Cost",xy.labels =as.character(by(sg$t_cost,sg$dte,sum)),col="darkorchid3");grid(col="grey")
plot.ts(unique(sg$dte),by(sg$t_clicks,sg$dte,sum),xlab="Date",ylab="Sum of Clicks",xy.labels =as.character(by(sg$t_clicks,sg$dte,sum)),col="goldenrod4");grid(col="grey")
plot.ts(unique(sg$dte),by(sg$t_impr,sg$dte,sum),xlab="Date",ylab="Sum of Impressions",xy.labels =as.character(by(sg$t_impr,sg$dte,sum)),col="green");grid(col="grey")
plot.ts(unique(sg$dte),by(sg$t_red,sg$dte,sum),xlab="Date",ylab="Sum of Redirects",xy.labels =as.character(by(sg$t_red,sg$dte,sum)),col="lightcoral");grid(col="grey")
#Group level plots
barplot(by(sg$t_rev,sg$cid_mod_group,sum),col="lightskyblue1",legend.text = "Sum of Revenue",main = "Sum of Revenue analysis per group ",xlab="Group")
barplot(by(sg$t_cost,sg$cid_mod_group,sum),col="red",legend.text = "Sum of Cost",main = "Sum of Cost analysis per group ",xlab="Group")
barplot(by(sg$t_impr,sg$cid_mod_group,sum),col="orchid",legend.text = "Sum of Impressions",main = "Sum of Impressions analysis per group ",xlab="Group")
barplot(by(sg$t_clicks,sg$cid_mod_group,sum),col="sienna",legend.text = "Sum of Clicks",main = "Sum of Clicks analysis per group ",xlab="Group")
barplot(by(sg$t_red,sg$cid_mod_group,sum),col="yellow",legend.text = "Sum of Redirects",main = "Sum of Redirects analysis per group ",xlab="Group")
```
<p><b><u> Summary of data</u></b></p>
```{r results='asis',warning=FALSE,error=FALSE,echo=F,comment=NA,tidy = F}
library(xtable)
x=summary(sg)
cnames=colnames(x)
x=t(x)
x=apply(x,2,as.character)
x=as.data.frame(x)
x=t(x)
x=as.data.frame(x)
cnames->colnames(x)
print(xtable(x,display=rep("s",dim(x)[2]+1)),type="html",include.rownames=FALSE)
```

