---
title: "Grouped cid Analysis"
---

```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
#input data
#UI
base_path="/home/devtest/"
#local
library(ggplot2)
library(reshape2)
#base_path="D:/"
pt<-paste(base_path,"sg_2.txt",sep="")
sg<-read.csv(pt,sep="\t")
nrow(sg)
```

<p><b><u> Head of data</u></b></p>
```{r results='asis',warning=FALSE,error=FALSE,echo=F,comment=NA,tidy = F}
library(xtable)
x=head(sg)
cnames=colnames(x)
x=t(x)
x=apply(x,2,as.character)
x=as.data.frame(x)
x=t(x)
x=as.data.frame(x)
cnames->colnames(x)
print(xtable(x,display=rep("s",dim(x)[2]+1)),type="html",include.rownames=FALSE)
```
<br/>
```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
#operations
#new columns
sg$t_nr<-sg$t_rev-sg$t_cost
sgm=melt(sg,id=c("dte","cid_mod_group"))
sgm$dte=as.Date(as.character(sgm$dte))
sgm$cid_mod_group=as.factor(sgm$cid_mod_group)
sgm$value=round(as.numeric(as.character(sgm$value)),2)
sgm_c=sgm[sgm$variable=='t_clicks',]
p<-ggplot()
p + geom_line(data=sgm_c,aes(x=dte,y=value,group=cid_mod_group,color=cid_mod_group))+xlab("Date")+ylab("Sum of Clicks")+ggtitle("Sum of Clicks per date for each cid group analysis")
```
<br/>

```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
sgm$cid_mod_group=as.factor(sgm$cid_mod_group)
sgm$value=round(as.numeric(as.character(sgm$value)),2)
sgm_c1=sgm[sgm$variable=='t_nr',]
p<-ggplot()
p + geom_line(data=sgm_c1,aes(x=dte,y=value,group=cid_mod_group,color=cid_mod_group))+xlab("Date")+ylab("Sum of Net_Revenue")+ggtitle("Sum of Net Revenue per date for each cid group analysis")
```
<br/>

```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
sgm$cid_mod_group=as.factor(sgm$cid_mod_group)
sgm$value=round(as.numeric(as.character(sgm$value)),2)
sgm_c2=sgm[sgm$variable=='t_rev',]
p<-ggplot()
p + geom_line(data=sgm_c2,aes(x=dte,y=value,group=cid_mod_group,color=cid_mod_group))+xlab("Date")+ylab("Sum of Revenue")+ggtitle("Sum of Revenue per date for each cid group analysis")
```
<br/>

```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
sgm$cid_mod_group=as.factor(sgm$cid_mod_group)
sgm$value=round(as.numeric(as.character(sgm$value)),2)
sgm_c3=sgm[sgm$variable=='t_cost',]
p<-ggplot()
p + geom_line(data=sgm_c3,aes(x=dte,y=value,group=cid_mod_group,color=cid_mod_group))+xlab("Date")+ylab("Sum of Cost")+ggtitle("Sum of Cost per date for each cid group analysis")
```
<br/>

```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
sgm$cid_mod_group=as.factor(sgm$cid_mod_group)
sgm$value=round(as.numeric(as.character(sgm$value)),2)
sgm_c4=sgm[sgm$variable=='t_impr',]
p<-ggplot()
p + geom_line(data=sgm_c4,aes(x=dte,y=value,group=cid_mod_group,color=cid_mod_group))+xlab("Date")+ylab("Sum of Imressions")+ggtitle("Sum of Impressions per date for each cid group analysis")
```
<br/>


```{r tidy=FALSE,warning=FALSE,comment=NA,message=FALSE,comment=NA,prompt=FALSE,collapse=FALSE,echo=FALSE}
sgm$cid_mod_group=as.factor(sgm$cid_mod_group)
sgm$value=round(as.numeric(as.character(sgm$value)),2)
sgm_c5=sgm[sgm$variable=='t_red',]
p<-ggplot()
p + geom_line(data=sgm_c5,aes(x=dte,y=value,group=cid_mod_group,color=cid_mod_group))+xlab("Date")+ylab("Sum of Redirects")+ggtitle("Sum of Redirects per date for each cid group analysis")
```
<br/>

